<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_script">
    <sys_ui_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <description>The React component renders a collapsable and expandable tree of navigation options.</description>
        <global>false</global>
        <ignore_in_now_experience>false</ignore_in_now_experience>
        <name>x_snc_reactor.TreeNavigation</name>
        <script><![CDATA[class TreeNavigation extends ReactorComponent
{
	constructor(props)
	{
		super(props);
		this.state = {
			treenavigation: this.props.treenavigation,
			filter: this.props.filter
		};
		BindAllFunctionsToThis(this);
	}

	onClick()
	{
		var strValue = GetStringValue(event.target.attributes.value.value);
		if (typeof this.props.callbackOnClick == 'function')
		{
			this.props.callbackOnClick(strValue);
		}
	}
	
	onClickCollapse()
	{
		var strValue = GetStringValue(event.target.attributes.value.value);
		this.setCollapsed(strValue,true);
	}	
	
	onClickExpand()
	{
		var strValue = GetStringValue(event.target.attributes.value.value);
		this.setCollapsed(strValue,false);
	}
	
	setCollapsed(strValue,bCollapsed)
	{
		var aPath = GetArrayValue(strValue);
		for (var nKey = 0; nKey < aPath.length; nKey++)
		{
			aPath[nKey] = GetIntegerValue(aPath[nKey]);
		}
		console.log(aPath);
		var treenavigation = this.state.treenavigation;
		
		if (aPath.length == 1)
		{
			treenavigation = SetValue(bCollapsed,treenavigation,
				'items',GetValue(aPath,0),
				'collapsed');
		}
		else if (aPath.length == 2)
		{
			treenavigation = SetValue(bCollapsed,treenavigation,
				'items',GetValue(aPath,0),
				'items',GetValue(aPath,1),
				'collapsed');
		}
		else if (aPath.length == 3)
		{
			treenavigation = SetValue(bCollapsed,treenavigation,
				'items',GetValue(aPath,0),
				'items',GetValue(aPath,1),
				'items',GetValue(aPath,2),
				'collapsed');
		}
		else if (aPath.length == 4)
		{
			treenavigation = SetValue(bCollapsed,treenavigation,
				'items',GetValue(aPath,0),
				'items',GetValue(aPath,1),
				'items',GetValue(aPath,2),
				'items',GetValue(aPath,3),
				'collapsed');
		}		
		console.log(treenavigation);
		this.setState( { treenavigation: treenavigation });	
	}
	
	onInputFilter()
	{
		var strValue = GetStringValue(event.target.value);
		//console.log('TreeNavigation::onInputFilter: '+strValue);
		
		this.setState( { filter: strValue });
	}

	renderNavigationRow(nLevel,children)
	{
		return e('div',
			{
				style:
				{
					flex: '0 0 auto',
					whiteSpace: 'nowrap',
					marginLeft: (nLevel * 15) + 'px'
				}
			},children);
	}
	
	
	render()
	{
		var treenavigation = this.state.treenavigation;
		
		var aLinkComponents = [];
		
		var strFilter = '';
		if (this.props.filter_show == true)
		{
			strFilter = GetStringValue(this.state.filter); 
			var componentFilterInput = e('input',{
				style: { width: '100%'},
				value: this.state.filter,
				onInput: this.onInputFilter,
				},null);

			aLinkComponents.push(componentFilterInput);
		}
		else
		{
			strFilter = GetStringValue(this.props.filter); 
			strFilter = strFilter.toLowerCase();	
		}
		
		function RenderNavigationTree(THIS,treenavigation,nLevel,aPath)
		{
			var bVisibleItems = false;
			nLevel = GetIntegerValue(nLevel);
			aPath = GetArrayValue(aPath);
			var aItems = GetArrayValue(GetValue(treenavigation,'items'));
			for (var nItem = 0; nItem < aItems.length; nItem++)
			{
				var aPathClone = Clone(aPath);
				//console.log(aPathClone);
				aPathClone.push(nItem);				
				
				var item = aItems[nItem];
				var strLabel = GetStringValue(GetValue(item,'label'));
				if (strLabel != '')
				{
					var bHasSubItems = false;
					var aSubItems = GetArrayValue(GetValue(item,'items'));
					if (aSubItems.length > 0)
					{
						bHasSubItems = true;
					}
					
					if (bHasSubItems == false)
					{
						var bVisible = true;
						if (strFilter != '')
						{
							var strLabelLowerCase = strLabel.toLowerCase();
							if (strLabelLowerCase.indexOf(strFilter) == -1)
							{
								bVisible = false;
							}
						}
						
						if (bVisible == true)
						{
							
							var strValue = GetStringValue(GetValue(item,'value'));
							aLinkComponents.push(
								THIS.renderNavigationRow(
									nLevel,
									e('a',
									{
										style: {
											borderLeft: (nLevel * 5) + 'px'
										},
										onClick: THIS.onClick,
										value: strValue,
									},strLabel)
								));
							bVisibleItems = true;
						}
					}
					else
					{
						var componentLinkCollapse = null;
						var bCollapsed = GetBoolValue(GetValue(item,'collapsed'));
						if (bCollapsed == true)
						{
							componentLinkCollapse = 
								e('a',
									{
										style:
										{
											fontWeight: 'bold',
										},
										onClick: THIS.onClickExpand,
										value: aPathClone,
									},
									[
										e(Icon, { icon: 'caret-right' }),
										strLabel
									]
								 );
						}
						else
						{
							componentLinkCollapse = 
								e('a',
									{
										style:
										{
											fontWeight: 'bold',
										},
										onClick: THIS.onClickCollapse,
										value: aPathClone,
									},
									[
										e(Icon, { icon: 'caret-down' }),
										strLabel
									]
								 );
						}
						/*
						aLinkComponents.push(
							THIS.renderNavigationRow(
								nLevel,
								e('span',
									{
										style: {
											fontWeight: 'bold',
										}
									},
									[componentLinkCollapse,strLabel])
								));
						*/

						aLinkComponents.push(
							THIS.renderNavigationRow(
								nLevel,
								componentLinkCollapse));
														
						componentLinkCollapse
						if (bCollapsed == false)
						{
							RenderNavigationTree(THIS,item,nLevel+1,aPathClone);							
						}
					}
				}
			}
			return bVisibleItems;
		}
		
		RenderNavigationTree(this,treenavigation);

		
		return e('div',
			{
				className: 'treenavigation',
				style:
				{
					display: 'table-cell',
					flexDirection: 'column',

					overflowY: 'auto',
					overflowX: 'auto',

					paddingLeft: '10px'
				}
			},aLinkComponents);		
	}	
}]]></script>
        <script_name>TreeNavigation</script_name>
        <sys_class_name>sys_ui_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-06-10 13:52:45</sys_created_on>
        <sys_id>ecc8aa5297d36910a6a07767f053af4f</sys_id>
        <sys_mod_count>99</sys_mod_count>
        <sys_name>x_snc_reactor.TreeNavigation</sys_name>
        <sys_package display_value="Reactor WORK IN PROGRESS" source="x_snc_reactor">e5879c7fdb39d110dcbdd03cd3961946</sys_package>
        <sys_policy/>
        <sys_scope display_value="Reactor WORK IN PROGRESS">e5879c7fdb39d110dcbdd03cd3961946</sys_scope>
        <sys_update_name>sys_ui_script_ecc8aa5297d36910a6a07767f053af4f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-10-03 17:54:10</sys_updated_on>
        <ui_type>0</ui_type>
        <use_scoped_format>false</use_scoped_format>
    </sys_ui_script>
</record_update>
